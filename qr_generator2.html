<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>QR</title>
    <style>
        img {}
    </style>
    <script src="/case/2/scripts/socket.io.min.js"></script>
    <script>
        function changeQR(text) {
            var element = document.getElementById("qr");
            const link = "https://iot-dod-2021.rtuitlab.dev/case/2?key=" + text;
            const qrLink = "https://chart.googleapis.com/chart?cht=qr&chs=500x500&chl=" + link;
            element.src = qrLink;
            document.getElementById("qr_link").setAttribute("href", link);
            document.getElementById("secret").innerHTML = text;
        }

        const SERVER = '';
        this.socket = io(SERVER, {
            path: '/case/2/ws/socket.io',
            transports: ["websocket"]
        });

        // handle the event sent with socket.send()
        socket.on("new_qr", data => {
            console.log(data);
            changeQR(data['qr_secret'])
        });

    </script>
</head>

<body>
    <img id="qr" src="https://orangenarwhals.com/wp-content/uploads/2011/11/Nyan-Catbw.jpg">
    <a id="qr_link">Link</a>
    <p id="secret"></p>
</body>

</html>